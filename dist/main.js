(()=>{"use strict";const e=function(e,t){var r=document.querySelector(".cards-container"),o=document.createElement("article");o.className="project-card",o.dataset.project=t;var a=document.createElement("h2");a.textContent=e;var n=document.createElement("button");n.textContent="X",n.className="btn-delete-project";var c=document.createElement("ul"),i=document.createElement("button");i.textContent="Add new task",o.append(a,n,c,i),r.append(o)},t=function(e,t,r){var o=document.querySelector("#select-project"),a=document.querySelector("#projects-view-selector"),n=document.createElement("option");n.value=t,n.textContent=e,"list"===r?o.append(n):"view"===r?a.append(n):window.alert("You have to select list or view as where parameter.")},r=function(e){var t=document.createElement("li"),r=document.createElement("input");r.setAttribute("type","checkbox"),r.className="checkbox",r.setAttribute("name","done"),!0===e.status&&(r.checked=!0);var o=document.createElement("label");o.setAttribute("for","done"),o.textContent=e.title,"true"===e.status&&(r.checked=!0,o.classList.add("done-task-txt"));var a=document.createElement("img");a.src="./img/trash.svg",a.className="erase-icon";var n=document.createElement("span");n.style="color: rgba(0, 0, 0, 0.5); float: right;",n.textContent=e.dueDate;var c=document.createElement("div");switch(e.priority){default:c.setAttribute("title","Low Priority"),c.className="low-priority-circle";break;case"mid":c.setAttribute("title","Medium Priority"),c.className="mid-priority-circle";break;case"high":c.setAttribute("title","High Priority"),c.className="high-priority-circle"}return t.append(r,o,a,n,c),t},o=function(e){var t=document.createElement("div");t.className="task-editor";var r=document.createElement("div");r.className="task-editor-window";var o=document.createElement("input");o.className="text-editor-inputs",o.setAttribute("type","text"),o.value=e.title,o.textContent=e.title;var a=document.createElement("textarea");a.className="text-editor-description",a.className="text-editor-inputs",a.value=e.description;var n=document.createElement("input");n.className="text-editor-inputs",n.setAttribute("type","date"),n.value=e.dueDate;var c=document.createElement("select");c.className="text-editor-inputs";var i=document.createElement("option");i.value="low",i.textContent="Low";var l=document.createElement("option");l.value="mid",l.textContent="Mid";var u=document.createElement("option");u.value="high",u.textContent="High",c.append(i,l,u),c.value=e.priority;var s=document.createElement("button");return s.id="save-changes",s.setAttribute("type","button"),s.innerText="Save changes / Close",r.append(o,a,n,c,s),t.append(r),t},a=function(){return{fetchLocalStorage:function(e){return null!==localStorage.getItem(e)&&"undefined"!==localStorage.getItem(e)?JSON.parse(localStorage.getItem(e)):"Projects"===e?["Default Project"]:[]},saveLocalStorage:function(e,t){localStorage.setItem(e,JSON.stringify(t))},urlDashedName:function(e){return e.split(/\s+/).join("-")},urlUndashedName:function(e){return e.split(/-+/).join(" ")}}};function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var c,i,l,u,s,d,m=a();const v=(c=function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"No description",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Default",a=arguments.length>3?arguments[3]:void 0,c=arguments.length>4?arguments[4]:void 0,i=arguments.length>5&&void 0!==arguments[5]&&arguments[5];n(this,e),this.title=t,this.description=r,this.project=o,this.dueDate=a,this.priority=c,this.status=i},i=function(e){var t=m.fetchLocalStorage("Tasks"),r=function(e,t){var r,o=t;return o.forEach((function(t){t.title===e&&(r=o.indexOf(t))})),r}(e.target.innerText,t),a=t[r],n=document.querySelector("body"),c=o(a);n.append(c),document.querySelector("#save-changes").addEventListener("click",(function(){!function(e){var t=m.fetchLocalStorage("Tasks"),r=t[e];r.title=document.querySelector(".text-editor-inputs[type=text]").value,r.description=document.querySelector("textarea").value,r.dueDate=document.querySelector(".text-editor-inputs[type=date]").value,r.priority=document.querySelector("select.text-editor-inputs").value,t[e]=r,m.saveLocalStorage("Tasks",t);var o=document.querySelector("body"),a=document.querySelector(".task-editor");o.removeChild(a),window.location.reload()}(r)}))},l=function(e){if(!0===window.confirm("Are you sure?")){var t=m.fetchLocalStorage("Tasks"),r=e.target.previousSibling.innerText,o=t.filter((function(e){return e.title!==r}));t=[].concat(o),m.saveLocalStorage("Tasks",t);var a=e.target.parentNode.parentNode,n=e.target.parentNode;a.removeChild(n)}},s=function(){document.querySelectorAll(".checkbox").forEach((function(e){e.addEventListener("change",u)})),document.querySelectorAll("label").forEach((function(e){e.addEventListener("click",i)})),document.querySelectorAll(".erase-icon").forEach((function(e){e.addEventListener("click",l)}))},{addToDo:d=function(){var e=arguments.length>1?arguments[1]:void 0,t=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,n=arguments.length>5&&void 0!==arguments[5]&&arguments[5],i=arguments.length>6&&void 0!==arguments[6]&&arguments[6];if(""===e)return alert("Task can't be empty.");var l=new c(e,"Default Description",t,o,a,n),u=document.querySelector('article.project-card[data-project="'.concat(t,'"]')),d=document.createElement("ul"),v=r(l);if(d.append(v),u.append(d),!1===i){var p=m.fetchLocalStorage("Tasks");p.push(l),m.saveLocalStorage("Tasks",p)}document.querySelector("#input-todo-name").value="",document.querySelector(".date-picker").value="",s()},loadTasks:function(){m.fetchLocalStorage("Tasks").forEach((function(e){localStorage.getItem("Projects").includes(m.urlUndashedName(e.project))&&d(e.description,e.title,e.project,e.dueDate,e.priority,e.status,!0)})),s()},markAsDone:u=function(e){var t=m.fetchLocalStorage("Tasks");t.forEach((function(t){t.title===e.target.nextSibling.innerText&&e.target.checked?t.status=!0:t.title!==e.target.nextSibling.innerText||e.target.checked||(t.status=!1)})),m.saveLocalStorage("Tasks",t)}});var p=function(){var r=a(),o=function(e){if(!0===window.confirm("Do you really want to delete the whole Project??")){var t=r.fetchLocalStorage("Projects"),o=r.fetchLocalStorage("Tasks"),a=e.target.previousElementSibling.innerText;t.splice(t.indexOf(a),1);var n=o.filter((function(e){return e.project!==a}));r.saveLocalStorage("Projects",t),r.saveLocalStorage("Tasks",n),window.location.reload()}},n=function(){document.querySelectorAll(".btn-delete-project").forEach((function(e){return e.addEventListener("click",o)}))};return{addNewProject:function(o){if(""===o)return alert("You cannot have empty name.");if(r.fetchLocalStorage("Projects").includes(o))return alert("Your project name is duplicated. Try another.");var a=r.urlDashedName(o);e(o,a),t(o,a,"list"),t(o,a,"view");var c=r.fetchLocalStorage("Projects");c.push(o),r.saveLocalStorage("Projects",c),n()},getProjectsList:function(){var e=[];return null!==r.fetchLocalStorage("Projects")?e=r.fetchLocalStorage("Projects"):(e=["Default Project"],localStorage.setItem("Projects",JSON.stringify(e))),e},spreadProjectsListToView:function(o){o.forEach((function(o){var a=r.urlDashedName(o);e(o,a),t(o,a,"list"),t(o,a,"view"),n()}))},deleteProject:o}}(),f=v,h=p.getProjectsList();p.spreadProjectsListToView(h),v.loadTasks();var g=document.querySelector(".input-project-name"),S=document.querySelector(".new-project-submit"),y=document.querySelector(".new-task-submit"),k=document.querySelector("#input-todo-name"),E=document.querySelector("#select-project"),j=document.querySelector(".date-picker"),x=document.querySelector(".priority-picker");S.addEventListener("click",(function(){p.addNewProject(g.value)})),y.addEventListener("click",(function(){return f.addToDo("Default Description",k.value,E.value,j.value,x.value,!1,!1)}))})();